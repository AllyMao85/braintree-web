!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(e.braintree||(e.braintree={})).paypal=t()}}(function(){var t;return function e(t,n,r){function i(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e,n,r){"use strict";!function(e,i){"object"==typeof r&&"undefined"!=typeof n?n.exports=i():"function"==typeof t&&t.amd?t([],i):e.framebus=i()}(this,function(){function t(t){return null==t?!1:null==t.Window?!1:t.constructor!==t.Window?!1:(v.push(t),!0)}function e(t){var e,n={};for(e in g)g.hasOwnProperty(e)&&(n[e]=g[e]);return n._origin=t||"*",n}function n(t){var e,n,r=o(this);return s(t)?!1:s(r)?!1:(n=Array.prototype.slice.call(arguments,1),e=a(t,n,r),e===!1?!1:(d(b.top,e,r),!0))}function r(t,e){var n=o(this);return _(t,e,n)?!1:(E[n]=E[n]||{},E[n][t]=E[n][t]||[],E[n][t].push(e),!0)}function i(t,e){var n,r,i=o(this);if(_(t,e,i))return!1;if(r=E[i]&&E[i][t],!r)return!1;for(n=0;n<r.length;n++)if(r[n]===e)return r.splice(n,1),!0;return!1}function o(t){return t&&t._origin||"*"}function s(t){return"string"!=typeof t}function a(t,e,n){var r=!1,i={event:t,origin:n},o=e[e.length-1];"function"==typeof o&&(i.reply=y(o,n),e=e.slice(0,-1)),i.args=e;try{r=x+JSON.stringify(i)}catch(s){throw new Error("Could not stringify event: "+s.message)}return r}function c(t){var e,n,r,i;if(t.data.slice(0,x.length)!==x)return!1;try{e=JSON.parse(t.data.slice(x.length))}catch(o){return!1}return null!=e.reply&&(n=t.origin,r=t.source,i=e.reply,e.reply=function(t){var e=a(i,[t],n);return e===!1?!1:void r.postMessage(e,n)},e.args.push(e.reply)),e}function u(t){b||(b=t||window,b.addEventListener?b.addEventListener("message",p,!1):b.attachEvent?b.attachEvent("onmessage",p):null===b.onmessage?b.onmessage=p:b=null)}function l(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})}function p(t){var e;s(t.data)||(e=c(t),e&&(f("*",e.event,e.args,t),f(t.origin,e.event,e.args,t),m(t.data,e.origin,t.source)))}function f(t,e,n,r){var i;if(E[t]&&E[t][e])for(i=0;i<E[t][e].length;i++)E[t][e][i].apply(r,n)}function h(t){return t.top!==t?!1:null==t.opener?!1:t.opener===t?!1:t.opener.closed===!0?!1:!0}function d(t,e,n){var r;try{for(t.postMessage(e,n),h(t)&&d(t.opener.top,e,n),r=0;r<t.frames.length;r++)d(t.frames[r],e,n)}catch(i){}}function m(t,e,n){var r,i;for(r=v.length-1;r>=0;r--)i=v[r],i.closed===!0?v=v.slice(r,1):n!==i&&d(i.top,t,e)}function y(t,e){function n(i,o){t(i,o),g.target(e).unsubscribe(r,n)}var r=l();return g.target(e).subscribe(r,n),r}function _(t,e,n){return s(t)?!0:"function"!=typeof e?!0:s(n)?!0:!1}var b,g,v=[],E={},x="/*framebus*/";return u(),g={target:e,include:t,publish:n,pub:n,trigger:n,emit:n,subscribe:r,sub:r,on:r,unsubscribe:i,unsub:i,off:i}})},{}],2:[function(t,e,n){"use strict";var r=t("./lib/set-attributes"),i=t("./lib/default-attributes"),o=t("./lib/assign");e.exports=function(t){var e=document.createElement("iframe"),n=o({},i,t);return n.style&&"string"!=typeof n.style&&(o(e.style,n.style),delete n.style),r(e,n),e.getAttribute("id")||(e.id=e.name),e}},{"./lib/assign":3,"./lib/default-attributes":4,"./lib/set-attributes":5}],3:[function(t,e,n){"use strict";e.exports=function(t){var e=Array.prototype.slice.call(arguments,1);return e.forEach(function(e){"object"==typeof e&&Object.keys(e).forEach(function(n){t[n]=e[n]})}),t}},{}],4:[function(t,e,n){e.exports={src:"about:blank",frameBorder:0,allowtransparency:!0,scrolling:"no"}},{}],5:[function(t,e,n){"use strict";e.exports=function(t,e){var n;for(var r in e)e.hasOwnProperty(r)&&(n=e[r],null==n?t.removeAttribute(r):t.setAttribute(r,n))}},{}],6:[function(t,e,n){"use strict";function r(t,e){var n,r=e?o(e):{},a=i(t.authorization).attrs,c=o(t.analyticsMetadata);r.braintreeLibraryVersion=s.BRAINTREE_LIBRARY_VERSION;for(n in r._meta)r._meta.hasOwnProperty(n)&&(c[n]=r._meta[n]);return r._meta=c,a.tokenizationKey?r.tokenizationKey=a.tokenizationKey:r.authorizationFingerprint=a.authorizationFingerprint,r}var i=t("./create-authorization-data"),o=t("./json-clone"),s=t("./constants");e.exports=r},{"./constants":12,"./create-authorization-data":14,"./json-clone":26}],7:[function(t,e,n){"use strict";function r(t){return Math.floor(t/1e3)}function i(t,e,n){var i=t.getConfiguration(),a=t._request,c=r(Date.now()),u=i.gatewayConfiguration.analytics.url,l={analytics:[{kind:e,timestamp:c}]};a({url:u,method:"post",data:s(i,l),timeout:o.ANALYTICS_REQUEST_TIMEOUT_MS},n)}var o=t("./constants"),s=t("./add-metadata");e.exports={sendEvent:i}},{"./add-metadata":6,"./constants":12}],8:[function(t,e,n){(function(t){"use strict";function n(e){return e=e||t.navigator.userAgent,e.indexOf("Opera Mini")>-1}function r(e){return e=e||t.navigator.userAgent,-1!==e.indexOf("MSIE")?parseInt(e.replace(/.*MSIE ([0-9]+)\..*/,"$1"),10):/Trident.*rv:11/.test(e)?11:null}function i(e){return e=e||t.location.protocol,"https:"===e}e.exports={isOperaMini:n,getIEVersion:r,isHTTPS:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(t,e,n){"use strict";function r(t,e){var n,r,o=document.createElement("a");return o.href=e,r="https:"===o.protocol?o.host.replace(/:443$/,""):"http:"===o.protocol?o.host.replace(/:80$/,""):o.host,n=o.protocol+"//"+r,n===t||i.test(t)}var i=/^https:\/\/([a-zA-Z0-9-]+\.)*(braintreepayments|braintreegateway|paypal)\.com(:\d{1,5})?$/;e.exports={checkOrigin:r}},{}],10:[function(t,e,n){"use strict";var r=t("../enumerate");e.exports=r(["CONFIGURATION_REQUEST"],"bus:")},{"../enumerate":16}],11:[function(t,e,n){"use strict";function r(t){if(t=t||{},this.channel=t.channel,!this.channel)throw new a({type:a.types.INTERNAL,message:"Channel ID must be specified."});this.merchantUrl=t.merchantUrl,this._isDestroyed=!1,this._isVerbose=!1,this._listeners=[],this._log("new bus on channel "+this.channel,[location.href])}var i=t("framebus"),o=t("./events"),s=t("./check-origin").checkOrigin,a=t("../error");r.prototype.on=function(t,e){var n,r,o=e,a=this;this._isDestroyed||(this.merchantUrl&&(o=function(){s(this.origin,a.merchantUrl)&&e.apply(this,arguments)}),n=this._namespaceEvent(t),r=Array.prototype.slice.call(arguments),r[0]=n,r[1]=o,this._log("on",r),i.on.apply(i,r),this._listeners.push({eventName:t,handler:o,originalHandler:e}))},r.prototype.emit=function(t){var e;this._isDestroyed||(e=Array.prototype.slice.call(arguments),e[0]=this._namespaceEvent(t),this._log("emit",e),i.emit.apply(i,e))},r.prototype._offDirect=function(t){var e=Array.prototype.slice.call(arguments);this._isDestroyed||(e[0]=this._namespaceEvent(t),this._log("off",e),i.off.apply(i,e))},r.prototype.off=function(t,e){var n,r,i=e;if(!this._isDestroyed){if(this.merchantUrl)for(n=0;n<this._listeners.length;n++)r=this._listeners[n],r.originalHandler===e&&(i=r.handler);this._offDirect(t,i)}},r.prototype._namespaceEvent=function(t){return["braintree",this.channel,t].join(":")},r.prototype.teardown=function(){var t,e;for(e=0;e<this._listeners.length;e++)t=this._listeners[e],this._offDirect(t.eventName,t.handler);this._listeners.length=0,this._isDestroyed=!0},r.prototype._log=function(t,e){this._isVerbose&&console.log(t,e)},r.events=o,e.exports=r},{"../error":17,"./check-origin":9,"./events":10,framebus:1}],12:[function(t,e,n){"use strict";var r="3.0.0-beta.8",i="web";e.exports={ANALYTICS_REQUEST_TIMEOUT_MS:2e3,INTEGRATION_TIMEOUT_MS:6e4,VERSION:r,INTEGRATION:"custom",SOURCE:"client",PLATFORM:i,BRAINTREE_LIBRARY_VERSION:"braintree/"+i+"/"+r}},{}],13:[function(t,e,n){"use strict";var r=t("./error");e.exports=function(t,e){e.forEach(function(e){t[e]=function(){throw new r({type:r.types.MERCHANT,message:e+" cannot be called after teardown."})}})}},{"./error":17}],14:[function(t,e,n){"use strict";function r(t){return/^[a-zA-Z0-9]+_[a-zA-Z0-9]+_[a-zA-Z0-9_]+$/.test(t)}function i(t){var e=t.split("_"),n=e[0],r=e.slice(2).join("_");return{merchantId:r,environment:n}}function o(t){var e,n,o={attrs:{},configUrl:""};return r(t)?(n=i(t),o.attrs.tokenizationKey=t,o.configUrl=a[n.environment]+"/merchants/"+n.merchantId+"/client_api/v1/configuration"):(e=JSON.parse(s(t)),o.attrs.authorizationFingerprint=e.authorizationFingerprint,o.configUrl=e.configUrl),o}var s=t("../lib/polyfill").atob,a={production:"https://api.braintreegateway.com:443",sandbox:"https://api.sandbox.braintreegateway.com:443"};e.exports=o},{"../lib/polyfill":28}],15:[function(t,e,n){"use strict";e.exports=function(t){return function(){var e=arguments;setTimeout(function(){t.apply(null,e)},1)}}},{}],16:[function(t,e,n){"use strict";function r(t,e){return e=null==e?"":e,t.reduce(function(t,n){return t[n]=e+n,t},{})}e.exports=r},{}],17:[function(t,e,n){"use strict";function r(t){if(!r.types.hasOwnProperty(t.type))throw new Error(t.type+" is not a valid type.");if(!t.message)throw new Error("Error message required.");this.message=t.message,this.type=t.type,this.details=t.details}var i=t("./enumerate");r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r.types=i(["CUSTOMER","MERCHANT","NETWORK","INTERNAL","UNKNOWN"]),e.exports=r},{"./enumerate":16}],18:[function(t,e,n){"use strict";function r(t){if(!t)throw new Error("Valid configuration is required");if(f.forEach(function(e){if(!t.hasOwnProperty(e))throw new Error("A valid frame "+e+" must be provided")}),!/^[\w_]+$/.test(t.name))throw new Error("A valid frame name must be provided")}function i(t,e){r(e),this._serviceId=u().replace(/-/g,""),this._frameConfiguration={name:e.name+"_"+this._serviceId,url:e.url,landingFrameHTML:e.landingFrameHTML},this._componentConfiguration=t,this._bus=new s({channel:this._serviceId}),this._setBusEvents()}var o=t("./popup"),s=t("../../bus"),a=t("../shared/events"),c=t("../shared/constants"),u=t("../../uuid"),l=t("iframer"),p=t("../../error"),f=["name","url","landingFrameHTML"];i.prototype.initialize=function(t){var e=function(){t(),this._bus.off(a.DISPATCH_FRAME_READY,e)}.bind(this);this._bus.on(a.DISPATCH_FRAME_READY,e),this._writeDispatchFrame()},i.prototype._writeDispatchFrame=function(){var t=c.DISPATCH_FRAME_NAME+"_"+this._serviceId,e=this._frameConfiguration.url+"/html/dispatch-frame.min.html";this._dispatchFrame=l({name:t,src:e,height:0,width:0}),document.body.appendChild(this._dispatchFrame)},i.prototype._setBusEvents=function(){this._bus.on(a.DISPATCH_FRAME_REPORT,function(t){this.close(),this._onCompleteCallback&&this._onCompleteCallback.call(null,t.err,t.payload),this._onCompleteCallback=null}.bind(this)),this._bus.on(s.events.CONFIGURATION_REQUEST,function(t){t(this._componentConfiguration)}.bind(this))},i.prototype.open=function(t){return this._onCompleteCallback=t,this._frame=o.open(this._frameConfiguration),this._pollForPopupClose(),{close:function(){this._frame.close()}.bind(this)}},i.prototype.close=function(){this.isFrameClosed()||this._frame.close()},i.prototype.teardown=function(){this.close(),this._dispatchFrame.parentNode.removeChild(this._dispatchFrame),this._dispatchFrame=null,this._cleanupFrame(),this._onCompleteCallback&&this._onCompleteCallback()},i.prototype.isFrameClosed=function(){return null==this._frame||this._frame.closed},i.prototype._cleanupFrame=function(){this._frame=null,clearInterval(this._popupInterval),this._popupInterval=null},i.prototype._pollForPopupClose=function(){return this._popupInterval=setInterval(function(){this.isFrameClosed()&&(this._cleanupFrame(),this._onCompleteCallback&&this._onCompleteCallback(new p({type:p.types.CUSTOMER,message:c.FRAME_CLOSED_ERROR_MESSAGE})))}.bind(this),c.POPUP_POLL_INTERVAL),this._popupInterval},e.exports=i},{"../../bus":11,"../../error":17,"../../uuid":29,"../shared/constants":24,"../shared/events":25,"./popup":21,iframer:2}],19:[function(t,e,n){"use strict";var r=t("./frame-service");e.exports={create:function(t,e,n){var i=new r(t,e);i.initialize(function(){n(i)})}}},{"./frame-service":18}],20:[function(t,e,n){"use strict";var r=t("../../shared/constants"),i=t("./position");e.exports=function(){return[r.POPUP_BASE_OPTIONS,"top="+i.top(),"left="+i.left()].join(",")}},{"../../shared/constants":24,"./position":23}],21:[function(t,e,n){"use strict";e.exports={open:t("./open")}},{"./open":22}],22:[function(t,e,n){(function(n){"use strict";var r=t("./compose-options");e.exports=function(t){return n.open(t.url+t.landingFrameHTML,t.name,r())}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./compose-options":20}],23:[function(t,e,n){(function(n){"use strict";function r(){var t=n.outerHeight||document.documentElement.clientHeight,e=null==n.screenY?n.screenTop:n.screenY;return o(t,s.POPUP_HEIGHT,e)}function i(){var t=n.outerWidth||document.documentElement.clientWidth,e=null==n.screenX?n.screenLeft:n.screenX;return o(t,s.POPUP_WIDTH,e)}function o(t,e,n){return(t-e)/2+n}var s=t("../../shared/constants");e.exports={top:r,left:i,center:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../shared/constants":24}],24:[function(t,e,n){"use strict";var r=535,i=450;e.exports={DISPATCH_FRAME_NAME:"dispatch",FRAME_CLOSED_ERROR_MESSAGE:"Frame closed before tokenization could occur.",POPUP_BASE_OPTIONS:"resizable,scrollbars,height="+r+",width="+i,POPUP_WIDTH:i,POPUP_HEIGHT:r,POPUP_POLL_INTERVAL:100,POPUP_CLOSE_TIMEOUT:100}},{}],25:[function(t,e,n){"use strict";var r=t("../../enumerate");e.exports=r(["DISPATCH_FRAME_READY","DISPATCH_FRAME_REPORT"],"frameService:")},{"../../enumerate":16}],26:[function(t,e,n){"use strict";e.exports=function(t){return JSON.parse(JSON.stringify(t))}},{}],27:[function(t,e,n){"use strict";e.exports=function(t){return Object.keys(t).filter(function(e){return"function"==typeof t[e]})}},{}],28:[function(t,e,n){(function(t){"use strict";function n(t){var e,n,r,i,o,s,a,c,u=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})([=]{1,2})?$"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p="";if(!u.test(t))throw new Error("Non base64 encoded input passed to window.atob polyfill");c=0;do i=l.indexOf(t.charAt(c++)),o=l.indexOf(t.charAt(c++)),s=l.indexOf(t.charAt(c++)),a=l.indexOf(t.charAt(c++)),e=(63&i)<<2|o>>4&3,n=(15&o)<<4|s>>2&15,r=(3&s)<<6|63&a,p+=String.fromCharCode(e)+(n?String.fromCharCode(n):"")+(r?String.fromCharCode(r):"");while(c<t.length);return p}var r="function"==typeof t.atob?t.atob:n;e.exports={atob:r,_atob:n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],29:[function(t,e,n){"use strict";function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})}e.exports=r},{}],30:[function(t,e,n){"use strict";function r(t){this._options=t,this._assetsUrl=t.client.getConfiguration().gatewayConfiguration.paypal.assetsUrl+"/web/"+s,this._authorizationInProgress=!1}var i=t("../../lib/frame-service/external"),o=t("../../lib/error"),s="3.0.0-beta.8",a=t("../shared/constants"),c=t("../../lib/constants").INTEGRATION_TIMEOUT_MS,u=t("../../lib/analytics"),l=t("../../lib/methods"),p=t("../../lib/deferred"),f=t("../../lib/convert-methods-to-error");r.prototype._initialize=function(t){var e=this._options,n=setTimeout(function(){u.sendEvent(e.client,"web.paypal.load.timed-out")},c);i.create(this._options,{name:a.LANDING_FRAME_NAME,url:this._assetsUrl,landingFrameHTML:"/html/paypal-landing-frame.min.html"},function(r){this._frameService=r,clearTimeout(n),u.sendEvent(e.client,"web.paypal.load.succeeded"),t()}.bind(this))},r.prototype.tokenize=function(t){var e;if("function"!=typeof t)throw new o({type:o.types.MERCHANT,message:"tokenize must include a callback function."});return e=this._options.client,t=p(t),this._authorizationInProgress?(u.sendEvent(e,"web.paypal.tokenization.error.already-opened"),t(new o({type:o.types.MERCHANT,message:"Another tokenization request is active."}))):(this._authorizationInProgress=!0,u.sendEvent(e,"web.paypal.tokenization.opened"),this._frameService.open(function(n){n?n.message===a.FRAME_CLOSED_ERROR_MESSAGE?u.sendEvent(e,"web.paypal.tokenization.closed.by-user"):u.sendEvent(e,"web.paypal.tokenization.failed"):u.sendEvent(e,"web.paypal.tokenization.success"),this._authorizationInProgress=!1,t.apply(null,arguments)}.bind(this))),{close:function(){u.sendEvent(e,"web.paypal.tokenization.closed.by-merchant"),this._frameService.close()}.bind(this)}},r.prototype.teardown=function(t){this._frameService.teardown(),f(this,l(r.prototype)),u.sendEvent(this._options.client,"web.paypal.teardown-completed"),"function"==typeof t&&(t=p(t))()},e.exports=r},{"../../lib/analytics":7,"../../lib/constants":12,"../../lib/convert-methods-to-error":13,"../../lib/deferred":15,"../../lib/error":17,"../../lib/frame-service/external":19,"../../lib/methods":27,"../shared/constants":32}],31:[function(t,e,n){"use strict";function r(t,e){var n,r,p;return e=u(e),null==t.client?void e(new a({type:a.types.MERCHANT,message:"options.client is required when instantiating PayPal."})):(n=t.client.getConfiguration(),p=n.analyticsMetadata.sdkVersion,p!==l?void e(new a({type:a.types.MERCHANT,message:"Client (version "+p+") and PayPal (version "+l+") components must be from the same SDK version."})):n.gatewayConfiguration.paypalEnabled!==!0?void e(new a({type:a.types.MERCHANT,message:"PayPal is not enabled for this merchant."})):i()?s.isHTTPS()?(c.sendEvent(t.client,"web.paypal.initialized"),r=new o(t),void r._initialize(function(){e(null,r)})):void e(new a({type:a.types.MERCHANT,message:"PayPal requires HTTPS."})):void e(new a({type:a.types.CUSTOMER,message:"Browser is not supported."})))}function i(){return!s.isOperaMini()}var o=t("./external/paypal"),s=t("../lib/browser-detection"),a=t("../lib/error"),c=t("../lib/analytics"),u=t("../lib/deferred"),l="3.0.0-beta.8";e.exports={create:r,VERSION:l}},{"../lib/analytics":7,"../lib/browser-detection":8,"../lib/deferred":15,"../lib/error":17,"./external/paypal":30}],32:[function(t,e,n){"use strict";var r=535,i=450;e.exports={AUTH_INIT_ERROR_MESSSAGE:"Could not initialize PayPal flow.",LANDING_FRAME_NAME:"braintreepaypallanding",POPUP_BASE_OPTIONS:"resizable,scrollbars,height="+r+",width="+i,POPUP_WIDTH:i,POPUP_HEIGHT:r,POPUP_POLL_INTERVAL:100}},{}]},{},[31])(31)});
